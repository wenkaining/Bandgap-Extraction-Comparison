Effect of the boundary condition on the vortex patterns in mesoscopic three-dimensional superconductors: Disk and sphere Mauro M. Doria,1,2,* Antonio R. de C. Romaguera,1,2 and F. M. Peeters2,‚Ä† 1Instituto de F√≠sica, Universidade Federal do Rio de Janeiro, Caixa Postal 68528, 21941-972 Rio de Janeiro, Brazil 2Departement Fysica, Universiteit Antwerpen, Groenenborgerlaan 171, B-2020 Antwerpen, Belgium Received 16 October 2006; revised manuscript received 29 November 2006; published 14 February 2007 The vortex state of mesoscopic three-dimensional superconductors is determined using a minimization procedure of the Ginzburg-Landau free energy.
We obtain the vortex pattern for a mesoscopic superconducting sphere and Ô¨Ånd that vortex lines are naturally bent and are closest to each other at the equatorial plane.
For a superconducting disk with Ô¨Ånite height, and under an applied magnetic Ô¨Åeld perpendicular to its major surface, we Ô¨Ånd that our method gives results consistent with previous calculations.
The matching Ô¨Åelds, the magne- tization and Hc3, are obtained for models that differ according to their boundary properties.
A change of the Ginzburg-Landau parameters near the surface can substantially enhance Hc3, as shown here.
DOI: 10.1103/PhysRevB.75.064505 PACS numbers: 74.78.Na, 74.25.Qt, 74.25.Ha I. INTRODUCTION In the last decade, the response of a mesoscopic supercon- ducting disk to a perpendicular magnetic Ô¨Åeld has been theoretically1,2 and experimentally3 studied.
The small vol- ume to surface ratio of mesoscopic superconductors brings different and interesting physical properties, such as giant vortices, recently detected thanks to the advances in small- tunnel-junction technology.4 Previous studies of mesoscopic systems were based on two-dimensional 2D theory, where the superconducting condensate was assumed to not vary along the direction of the magnetic Ô¨Åeld.
This assumption is not taken here and we study Ô¨Ånite-size extreme type-II me- soscopic superconductors using a truly three-dimensional 3D theoretical approach, previously applied to a bulk superconductor.5,6 Only a few vortices Ô¨Åt inside a mesoscopic supercon- ductor, whereas for a bulk superconductor, with nonsuper- conducting inclusions inside, the number of vortices is un- countable.
By inclusion, we refer to a pinning center with the size equal to a few multiples of the coherence length .
These two systems have similar properties because of their mesoscopic scale structure.
For instance, giant vortices are naturally found in mesoscopic superconductors but not in bulk superconductors, where the nucleation of a vortex line with multiple magnetic Ô¨Çux N0 is energetically forbidden and only the nucleation of N individual vortex lines with 0 is possible 0 is the quantum of Ô¨Çux. However, this picture does not hold in the presence of inclusions.
For instance, for a bulk superconductor, Mkrtchyan and Shmidt,7 Buzdin,8 and some of us9,10 have shown that a columnar defect can hold a multiple magnetic Ô¨Çux N0.
Metastability, matching Ô¨Åelds, occupation numbers, and giant vortices have been experimentally studied in 2D bulk superconductors with inclusions, namely, superconducting Ô¨Ålms with an array of two-dimensional mesoscopic pinning centers consisting of not fully perforated holes blind holes,11 fully perforated holes open holes,12,13 and microholes.14,15 A similar 3D bulk superconductor with a truly three-dimensional arrangement of internal inclusions has yet to be experimentally realized though it has been theo- retically studied.9,10 Such internal inclusions are present as a random array16,17 in the LREBaCuO superconductors where LRE is a light rare-earth element such as Nd, Sm, Eu, and Gd and some of the present ideas may be useful to explain their unusual properties.
Such internal inclusions bring other features to vortex physics as just a single one can trap many vortex lines in its neighborhood.
The regular array theoreti- cal study of the 3D bulk superconductor with inclusions was done in the context of a modiÔ¨Åed version of the Ginzburg- Landau GL theory.
Other studies based on the Ginzburg- Landau theory for 3D systems have been done, including shells18 and constricted superconducting wires,19 both in the extreme type-II limit.
In this paper, we apply the same theoretical approach to study a mesoscopic superconductor.
A 3D lattice of inclu- sions turns into a 3D lattice of mesoscopic superconductors with the same geometry when the insulating regions are re- placed by superconducting ones and vice versa.
The 3D lat- tice of mesoscopic superconductors becomes a set of indi- vidually equivalent mesoscopic superconductors for a London penetration length much larger than their size.
In this case, the local Ô¨Åeld is constant and equal to the applied Ô¨Åeld everywhere.
In this way, we obtain the vortex patterns for a single mesoscopic superconductor, here of a sphere and of a disk.
In the past, the vortex patterns of mesoscopic supercon- ductors were obtained1,2,20,21 in the limit of an extremely thin Ô¨Ålm.
This condition renders the variation of the Cooper pair density along the magnetic Ô¨Åeld negligible.
Baelus and Peeters21 studied several different Ô¨Çat geometries typically with a thickness of 0.1 and obtained the vortex patterns from the two-dimensional GL equations supplemented by the Saint-James‚Äìde Gennes22 boundary conditions at the edge.
They considered a Ginzburg-Landau parameter, the ratio of the London penetration to the coherence length, =0.28, and solved the two GL equations.
Here, we study a thick disk and compare our results to theirs,21 taking into account that, in their case, the magnetic response to an external applied Ô¨Åeld is much stronger than here.
We only report results for  ‚Üí although our method is not restricted to this limit.
No- tice that, for our case, the boundary conditions are truly three dimensional, and so, imposed in all directions including per- pendicularly to the Ô¨Çat geometry.
The major results of this paper can be summarized as follows.
i We Ô¨Ånd the vortex pattern for a mesoscopic PHYSICAL REVIEW B 75, 064505 2007 1098-0121/2007/756/0645057 ¬© 2007 The American Physical Society 064505-1sphere, with radius Rs=4.0. ii We show that a slight change of the Ginzburg-Landau parameters near the edge can substantially increase the Hc3 Ô¨Åeld.
A thin layer covers the superconductor and separates it from the outside insulating world.
This layer is also superconducting but with effective GL parameter slightly different from those inside.
For a bulk system, the phenomenological GL parameters are known to be related to the microscopic parameters in the following way: 0kTc2/F and kTc2/Fn, where Tc is the critical temperature, F is the Fermi energy, and n is the electronic density.
Similar relations should exist in case of a mesoscopic superconductor, although we do not obtain them here.
We just show that a decrease near the edges of 1/m, m being the effective Cooper pair mass, and of 0, leads to an enhancement of Hc3.
Therefore, the present approach is in- teresting for a system with a small volume to surface ratio, because a slight change at the boundary over a distance less or equal to  is found here to make a signiÔ¨Åcant difference.
The present approach relies on a free-energy minimization procedure carried in the whole space, including the world outside the superconductor, where the order parameter van- ishes.
The decay of the Cooper pair density at the boundary, from a Ô¨Ånite value inside the mesoscopic superconductor to zero outside, is treated here.
Notice that standard differential equation approaches, such as that of Ref. 21, only treat the volume internal to the superconductor, but do not treat the order parameter discontinuity at the edge, from a Ô¨Ånite value to zero at the outside world.
In this paper, we study three kinds of boundary conditions and discuss them in the context of a disk of radius R=4.0. Below, we provide a short description of the disk and sphere boundary problems treated here.
We chose to give them names that recall their major features.
i Sharp: A disk is considered and its boundary treatment is the standard one used for comparison with all other models.
A coarse-grained grid is used and gives a fast and efÔ¨Åcient convergence to the Ô¨Ånal conÔ¨Åguration.
The vortex states are satisfactorily de- scribed here.
Its name stems from the sharp deÔ¨Ånition of the edge.
ii Mesh: This model is the same as sharp except with a reÔ¨Åned grid, which contains 8.2 times more grid points.
iii Sphere: A sphere is treated here with the same grid coarseness along the disk radial direction as in the sharp model.
iv BP2D: This is the disk reported by Baelus and Peeters21 using their 2D approach.
v Smooth: This type of boundary was previously used in Refs.
23 and 24 for insu- lating pinning spheres inside a bulk superconductor and is used here for the disk.
Its major property is that the super- current normal to the surface does not disappear abruptly but over some small region fraction of . vi Step: This model contains a superconducting layer that sets the disappearance of superconductivity.
Thus, there are two concentric disks and we Ô¨Ånd that this intermediate layer stabilizes the super- conducting state in the inner disk.
This model features a very high Hc3 as compared to the other models.
The paper is organized as follows.
In Sec. II, we describe our theoretical approach as valid for the following two complementary situations: i Superconductor with nonsu- perconducting inclusions and ii mesoscopic supercon- ductor. In Sec.
III, we describe the disk and sphere boundary models and discuss their properties obtained through our nu- merical simulations. In Sec.
IV, we compare the models and discuss many of their common features.
Finally, in Sec. V, we summarize the main achievements of this work. II.
THEORETICAL ASPECTS One of the advantages of the present method is that it can easily incorporate the shape of the mesoscopic supercon- ductor, which is done at the free-energy level, given by the density expansion: F = dv VrD 	2 2m + r0T ‚àíTc	2 +  2 	4 + h2 8 , 1 where D /i ‚àíqA /c, q is the Cooper pair charge, and r is a steplike function, equal to 1.0 inside the mesoscopic superconductor and 0 outside.
The r contains the geom- etry of the mesoscopic superconductor.
The corresponding Euler-Lagrange equations are given by i 2m r ¬∑ D 	 + rD 2	 2m + r0T ‚àíTc	 + 	2	 = 0, 2  h = 4 J c , J = q 2mr		*D 	 + D 	*	 .
3 These modiÔ¨Åed GL equations automatically incorporate the appropriate boundary conditions through the steplike func- tion r, discontinuous at the edge, equal to 1.0 inside and 0.0 outside, for the mesoscopic superconductor.
The gradient of r is zero everywhere except at the interface, where it diverges.
Any Ô¨Ånite and physical solution must obey  ¬∑D 	=0 because this divergence is proportional to the Dirac delta function.
For instance, along the radial direction of the disk, r=1 for r R and r=0 for xR, thus the derivative becomes  =rÀÜr/r=‚àírÀÜr‚àíR. Let fr be any function describing products of the order parameter and its derivatives.
The product frr/r diverges at the bor- der and the only way to make it vanish there is through the condition fR=0.
Thus, the well-known Saint-James‚Äìde Gennes22 boundary condition, nÀÜ ¬∑D 	n=0, is recovered here.
As the superconducting order parameter is deÔ¨Åned every- where in the unit cell, including outside the mesoscopic superconductor, Eq. 1 becomes F=1/Vdv		4/2 +h2/8   outside the superconducting volume.
It must vanish as a result of the free energy minimization, and variation with respect to 	 and A shows that the minimum is reached for 	=0 and  h =0 according to Eqs.
2 and 3. It is possible to obtain more elaborate versions of the GL theory, such as the one containing a local depression of the critical temperature through a function Tcr Ref.
9 in Eq. 2. In this work, the free energy is normalized by the constant F0 =Hc 2/8  and all Ô¨Åelds are normalized in terms of the upper critical Ô¨Åeld Hc2.
Lengths are in units of the coherence DORIA, DE C. ROMAGUERA, AND PEETERS PHYSICAL REVIEW B 75, 064505 2007 064505-2length, T=2/2m0Tc‚àíT, and the density 	2 is nor- malized by 0Tc‚àíT/, such that its maximum value of 1 is reached, for instance, inside a bulk superconductor no boundaries for zero applied Ô¨Åeld.
We stress some differences in the application of the present method to the two complementary problems.
For the former case the magnetic induction, B =dvh /V, is constant, whereas for the latter the applied Ô¨Åeld H is constant.
In the former case, the unit cell edges are fully inside the supercon- ductor and this introduces into the theory integers associated with the periodic boundary conditions imposed by the unit cell.
These integers follow the condition that the order pa- rameter must be single valued.
Though 	2 and h are peri- odic, 	 and A only need to coincide at the unit cell surfaces up to a gauge transformation, whose expression gives room to introduce these integers.
r + L = ei2 /0r	r, 4 Ar + L = Ar + r, 5 where L is the unit cell length, r is a scalar gauge function, and =x, y, or z.
The minimization procedure shows that such integers are nothing but the number of vor- tices in the unit cell, and the magnetic induction is fully determined by them.
However, for the complementary prob- lem, the mesoscopic superconductor is fully inside the unit cell and its boundaries are away from the unit cell edges.
Consequently, there is no single-valued condition on the or- der parameter and so, these integers do not exist at all.
Con- sequently, the independent thermodynamic Ô¨Åeld in this case, which is the applied Ô¨Åeld H , varies continuously.
Since there are no screening currents, the local Ô¨Åeld, de- Ô¨Åned as h = A, is the external applied Ô¨Åeld h =H .
In this large  limit, the magnetization is directly determined from M =constdvrJ, where J is the supercurrent.
An extra condition determines the remaining free parameter const, and consequently, the demagnetization constant D of the mesos- copic superconductor: for small H , that is, in the Meissner phase, we impose the condition that H +4 DM =0.
In con- trast, in the approach of Baelus and Peeters21 for Ô¨Ånite , the magnetization is directly obtained from the difference be- tween the magnetic induction and the applied Ô¨Åeld.
The minimization of the GL free energy, done numerically through the so-called simulated annealing method,25,26 is car- ried in a discrete three-dimensional space.
The free energy is adapted to keep its gauge invariance in this discrete space.
A cell consists of an orthorhombic box containing NxNyNz points for this purpose.
Every point in this cell, whether or not it belongs to the mesoscopic superconductor, has associ- ated with it the Ô¨Åelds 	nx,ny,nz and Anx,ny,nz, where nx=1, ... ,Nx, ny=1, ... ,Ny, and nz=1, ... ,Nz.
The physical volume of the box is LxLyLz, where Lx=axNx‚àí1, Ly =ayNy‚àí1, and Lz=azNz‚àí1. The distance between two consecutive points along the axes of the box is ax, ay, and az.
The discrete theory, given by Eq. 6, properly describes the properties of the continuous theory under the condition that  must be much larger than ax, ay, and az, the grid resolution.
In the discrete free energy, given by Eq. 6, grid points outside and inside the mesoscopic superconductor are coupled through gradient terms.
For instance, in the case of no applied Ô¨Åeld, this coupling is proportional to 	out  ‚àí	in2.
The fact that 	out  ‚Üí0 causes 	in to get a lower value than deep inside the sample, where the kinetic energy vanishes as the order parameter is the same in all points.
For this reason, the density 	2 never reaches its maximum bulk value due to the small volume to surface ratio.
F = 1 NxNyNz  nx=1 Nx  ny=1 Ny  nz=1 Nz  2 2m 1 ax 2 n + xÀÜ + n 2 	n + xÀÜ ‚àíei2 ax/0Axn	n2 + 2 2m 1 ay 2 n + yÀÜ + n 2 	n + yÀÜ ‚àíei2 ay/0Ayn	n2 + 2 2m 1 az 2 n + zÀÜ + n 2 	n + zÀÜ ‚àíei2 az/0Azn	n2 + n0T ‚àíTc n2 +  2 	n4. 6 III.
COMPARISON OF THE DIFFERENT MODELS The models introduced in Sec.
I have their properties summarized in Tables I and II, and some of their free energy and magnetization properties are described in Tables III and IV, respectively.
The function r is taken as the product of independent orthogonal direction functions for all models studied here.
A summary of their features is shown below.
i Sharp: This model treats the boundaries of a disk of radius R=4.0 and height d=1.0 through a r function, 1 inside and 0 outside; both along the radial and the major axis di- rection: r=¬∑dz. ii Mesh: The same disk and boundaries of the sharp model is treated here but with a denser grid, 616126 instead of 41417. iii Sphere: TABLE I.
The different models considered in this paper, where r=¬∑dz. Rs is the sphere radius.
Ri and di are the internal disk radius and height, respectively.
Model  dz Sharp = 1,  R 0, R d= 1, 2z d 0, 2zd Mesh Idem Idem Sphere r= 1 r Rs 0 rRs ¬Ø BP2D Differential equation ¬Ø Smooth =2/	1+e/RN d=2/	1+e2z/dN Step = 1,  Ri 0.8, Ri R 0, R  d= 1, 2z di 0.8, di2z d 0, 2zd  EFFECT OF THE BOUNDARY CONDITION ON THE‚Ä¶ PHYSICAL REVIEW B 75, 064505 2007 064505-3This model treats a sphere with stepwise r function, such as that in the sharp model.
iv BP2D: This is the disk of Ref. 21.
It has a 0.1 height and a 1281281 grid is used.
Despite its 2D treatment, it contains 1.4 times more grid points than the three-dimensional sharp disk model.
v Smooth: For this model, a larger height is taken, 2.0, to help stabilize the order parameter inside the disk.
The smoothness of dz, which reaches values below 1 inside the region z  d/2, tends to downgrade the order parameter inside the disk.
For our numerical study, we selected, for the exponen- tial parameter of Table I, N=8.
vi Step: The height is d =1.5 and the r function varies stepwise, taking values of 0, 0.8, and 1.
The choice of intermediate value 0.8 is rather arbitrary and we have found that lowering this intermediate value to 0.5, for instance, causes a substantial increase of Hc3, as compared to here.
Thus, a drop of  near the border, and of the corresponding GL parameters, can severely affect Hc3.
Figure 1 shows the normalized density for zero applied Ô¨Åeld Meissner phase versus the distance from the geometric center of the disk along the radial direction, and in the case of the sphere, this distance is along the radial direction inside the equatorial plane.
For clarity, the six models considered here were split into two subsets shown in different plots.
For comparison purposes, the BP2D model is shown in both plots red. Note that for the BP2D model, as well as for the sphere model, the maximum density is 1.0, but not for the other disk models whose maximum density is about 0.8.
The sphere has a larger volume than the disk, and so the surface is not so effective in altering the order parameter in its center.
In the presence of an applied Ô¨Åeld, the numerical simula- tion is carried out in the following way.
For zero applied Ô¨Åeld, a random conÔ¨Åguration of the order parameter is as- sumed inside the cell and a search for the minimum of the free energy is carried out.
The applied Ô¨Åeld is increased at constant steps and for a given Ô¨Åeld, one assumes the one found for the previous Ô¨Åeld as the starting order parameter conÔ¨Åguration.
This procedure is carried sequentially until the last critical Ô¨Åeld Hc3 is reached and the order parameter van- TABLE III.
The matching Ô¨Åelds hL L+1 between the angular mo- mentum states L and L+1 for the different models considered here.
hi i+1 Sharp Mesh Sphere BP2D Smooth Step h0 1 0.31 0.30 0.41 0.39 0.30 0.31 h1 2 0.51 0.51 0.65 0.59 0.52 0.54 h2 3 0.69 0.68 0.84 0.74 0.69 0.72 h3 4 0.85 0.83 1.00 0.89 0.84 0.88 h4 5 0.99 0.98 1.15 1.02 0.99 1.03 h5 6 1.14 1.12 1.28 1.16 1.13 1.20 h6 7 1.28 1.26 1.42 1.30 1.27 1.34 h7 8 1.43 1.41 1.56 1.43 1.41 1.48 h8 9 1.57 1.54 ¬Ø 1.57 1.54 1.62 h9 10 1.70 1.69 ¬Ø 1.71 1.68 1.84 h10 11 1.87 1.82 ¬Ø 1.84 ¬Ø 2.05 h11 12 ¬Ø ¬Ø ¬Ø ¬Ø ¬Ø 2.19 TABLE II.
The parameters of the different models used in our numerical calculation.
Model Grida Cellb Parametersc Sharp 41,41,7 0.3,0.3,0.5 d=1.0 Mesh 61,61,26 0.2,0.2,0.2 d=1.0 Sphere 41,41,41 0.3,0.3,0.3 Rs=4.0 BP2D 128,128,1 0,0,- Smooth 41,41,13 0.3,0.3,0.5 d=2.0, N=30 Step 41,41,7 0.3,0.3,0.5 d=1.5, Ri=3.5, di=0.5 aThe number of grid points for the three cell directions: Nx,Ny,Nz.
bThe lattice spacing for the three cell directions: ax,ay,az. cAll the lengths are in units of .
The disk radius is R=4.0 for all cases. TABLE IV.
Points hL/Hc2,‚àí4 DML/Hc2 are the maximum of the magnetization lines associated with the angular momentum L curves for the different models.
L Sharp Mesh Sphere BP2D Smooth Step 0 0.38,0.25 0.39,0.25 0.43,0.28 0.58,0.44 0.39,0.25 0.44,0.28 1 0.58,0.19 0.59,0.20 0.66,0.19 0.73,0.39 0.59,0.19 0.64,0.22 2 0.75,0.14 0.75,0.15 0.84,0.13 0.86,0.34 0.75,0.14 0.81,0.17 3 0.91,0.11 0.90,0.12 0.98,0.090 0.98,0.29 0.90,0.10 0.98,0.13 4 1.05,0.082 1.04,0.089 1.14,0.060 1.11,0.24 1.04,0.077 1.13,0.11 5 1.19,0.060 1.18,0.067 1.27,0.038 1.23,0.20 1.17,0.055 1.27,0.083 6 1.32,0.044 1.30,0.049 1.39,0.022 1.34,0.15 1.30,0.038 1.41,0.064 7 1.44,0.030 1.43,0.034 1.50,0.011 1.45,0.12 1.41,0.025 1.55,0.048 8 1.56,0.019 1.54,0.022 1.60,0.0034 1.56,0.083 1.53,0.015 1.67,0.036 9 1.67,0.011 1.67,0.013 ¬Ø 1.66,0.054 1.64,0.0072 1.80,0.026 10 1.78,0.0046 1.77,0.0057 ¬Ø 1.78,0.029 1.74,0.0023 1.92,0.016 11 1.88,8.810‚àí4 1.86,9.710‚àí4 ¬Ø 1.87,0.0096 ¬Ø 2.03,0.010 12 ¬Ø ¬Ø ¬Ø ¬Ø ¬Ø 2.14,0.0051 13 ¬Ø ¬Ø ¬Ø ¬Ø ¬Ø 2.24,0.0019 DORIA, DE C. ROMAGUERA, AND PEETERS PHYSICAL REVIEW B 75, 064505 2007 064505-4ishes everywhere.
Next, the applied Ô¨Åeld is lowered to zero applied Ô¨Åeld.
A typical feature of mesoscopic superconductors1,2 is a saw-tooth structure for the descend- ing Ô¨Åeld of magnetization curve.
The two curves do not co- incide; the ascending one has a stronger diamagnetic signal than the descending curve.
The mesoscopic superconductor exhibits hysteresis as observed, e.g., in Al disks,3 and theo- retically obtained in previous studies.1,21 Metastability is also found in the complementary problem of bulk superconduct- ors with inclusions.5,6 Note that all the magnetization curves shown here Figs. 2‚Äì4 decompose into independent nonintersecting lines and result from ancestor curves that contain their ascending and descending branches.
The saw-tooth structure is a sum of segments, which are parts of the independent nonintersecting lines.
Two consecutive segments are connected by a vertical jump.
The reason for such vertical jumps resides in the free- energy curve, which also consists of independent but inter- secting lines.
In fact, these intersections deÔ¨Åne the so-called matching Ô¨Åelds which correspond to the cross sections of the free-energy lines of neighboring states.
Above the matching Ô¨Åeld, the free-energy of the higher state is lower than that of the preceding one and thus, the higher state is preferred.
This is also the reason for the saw-tooth character of the hysteresis curve.
Depending on how the numerical procedure is carried out, the magnetic-Ô¨Åeld step, the simulated annealing tem- perature, etc., one obtains a different saw-tooth structure that always falls over the same set of independent noninter- secting lines.
The presence of distinct lines in the magneti- zation and free-energy curves reveals a parameter that re- mains constant upon Ô¨Åeld sweep.
A look at the order parameter phase reveals that it takes variations from 0 to 2 and the number of such variations remains constant through- out a magnetization line.
Thus, this parameter is the total angular momentum L.1,2 Along any of these lines, the angu- lar momentum remains constant, such that each line can be labeled by L. Along any of these lines the angular momen- tum remains constant, such that each line can be labeled by L. For ascending Ô¨Åeld, the vortex pattern moves from L-independent vortices at low Ô¨Åeld to giant vortex states at high Ô¨Åeld, whose total angular momentum must add to L. Therefore, the present method is able to reproduce the well- known features of mesoscopic superconductors found by other authors using different approaches.1,21 Table III shows the matching Ô¨Åelds hLL+1 between two nearest angular momentum states for the six models consid- ered here.
Table IV is useful for model comparison, as it shows the maximum value of ‚àí4 DML/Hc2 for each L line and its corresponding applied Ô¨Åeld hL/Hc2. IV.
DISCUSSION In this section, we compare all models to the sharp bound- ary model for the mesoscopic disk whose properties are shown in Tables III and IV.
The effect of the number of grid points in our calculations can be checked in Fig. 2, as the mesh model has 8.2 times more grid points than the sharp model.
The mesh model has a lower free energy and a higher magnetization than the sharp model, but their values differ by less than 1%.
Effects due to the grid become only notice- able for intermediate Ô¨Åelds, but not in the single vortex re- gion.
The comparison between sharp and mesh models shows that the present numerical approach is robust and dis- plays very little quantitative dependence on the grid.
Figure 2 also shows the isodensity three-dimensional plots of four typical vortex conÔ¨Ågurations selected to display 1, 2, 3, and 4 vortex states, respectively.
Their corresponding applied Ô¨Åeld, magnetization, and free energy values can be read from Fig. 2. FIG.
1. Color online Cooper pair density 2 vs the distance from the center of the disk for the case of the Meissner state in the absence of an applied Ô¨Åeld.
The symbols correspond to 2 values at the mesh grid points. FIG.
2. Color online The sharp red and the mesh disks free- energy and magnetization curves are shown here.
Isodensity plots for selected applied Ô¨Åelds are shown here to illustrate the Ô¨Årst four cases of vortex patterns found for the thick disk.
The three- dimensional Ô¨Ågures are isocontours taken at 20% of the maximum density 	2.
Each isocontour is a single surface, the sum of the vortices, and the external surface.
EFFECT OF THE BOUNDARY CONDITION ON THE‚Ä¶ PHYSICAL REVIEW B 75, 064505 2007 064505-5Figure 3 shows the results of the magnetization and free energy for the sphere model, and also for the sharp disk model.
3D isodensity and 2D contour plots are shown for four selected vortex conÔ¨Ågurations, whose location is indi- cated in the free-energy curve.
These four vortex conÔ¨Ågura- tions illustrate general features of the vortex lines inside the sphere.
A vortex line must reach the surface perpendicularly in order to avoid a supercurrent component pointing out- wards the surface.27,28 Because of the small volume to sur- face ratio of this Rs=4.0 sphere, the vortex lines are strongly affected by this surface effect and, as a result, they are curved everywhere inside the sphere.
The lines are closely packed in the equatorial plane, as shown by the 3D isodensity plots.
These plots are drawn at 20% of the maxi- mum order density and each plot consists of a single isoden- sity surface.
The north pole part of these plots provides a view of the vortex behavior at the surface, but the translucent properties of these 3D plots make it difÔ¨Åcult to have the same view at the south pole.
Figure 3 also shows 2D contour plots associated with two selected cuts of the sphere, taken at the equatorial half-plane and halfway between the north or south pole and the equator planes quarter-plane.
These contour plots contain ten contour regions, shown in different colors, ranging from maximum density red to minimum density blue.
They also show that the vortex lines are closely packed at the equatorial plane and also that the vor- tex core is larger near the surface than inside the sphere.
The sphere has a stronger magnetic signal as compared to the disk for low Ô¨Åelds, but for high Ô¨Åelds up to Hc3, the situation turns and the disk acquires a stronger signal. In fact, the FIG.
3. Color online The sphere and the sharp red disk free-energy and magnetization curves are shown in the right panels.
Three- dimensional isodensity plots and two- dimensional density contour plots of 	2 are also shown in the right panels.
Each three- dimensional isocontour is a single surface, made of the sum from the vortices and the external sur- face.
Two-dimensional contour plots are taken at the half equatorial and at the quarter plane that cuts the sphere perpendicularly to the applied Ô¨Åeld direction. FIG.
4. Color online 	a and b  The two-dimensional BP2D disk and the three-dimensional sharp red disk magnetization and free energy.
c and d  The step and the sharp red disk magnetization and free energy.
e and f The smooth and the sharp red disk magnetization and free energy.
DORIA, DE C. ROMAGUERA, AND PEETERS PHYSICAL REVIEW B 75, 064505 2007 064505-6sphere only supports nine vortex states, whereas the disk supports 12 states.
As the Ô¨Åeld increases, the vortex conÔ¨Ågu- ration in the case of the sphere disappears faster than in the disk, which is probably due to the existence of vortex lines of different lengths.
Figure 4 shows comparative analysis of the free-energy and magnetization curves to the sharp model for the BP2D, step, and smooth models.
i BP2D-sharp: Their different  values yield signiÔ¨Åcantly different magnetization curves.
The BP2D model has a very strong diamagnetic signal and lower free-energy states, because it has a more effective shielding to the applied Ô¨Åeld.
Nevertheless, the models show qualita- tive similarities.
They both have the same number of 12 an- gular momentum states, as shown in Table III, and present a fair agreement between matching Ô¨Åelds in the high-Ô¨Åeld re- gion.
This is explained by the weakening of the diamagnetic currents for high Ô¨Åeld that turns the BP2D similar to the sharp model.
ii Step-sharp: The presence of an intermedi- ate region at the boundary enlarges surface effects as com- pared to the sharp case.
The diamagnetic response is stron- ger, and the free energy is lower in all L lines and, in fact, it allows for two extra vortex states, according to Table III.
These features are not a consequence of a slight difference in height between the two models.
iii Smooth-sharp: The smooth model treats the boundary differently from the sharp model in case the smooth  function decay takes place over a distance larger than the mesh parameters ax, ay, and az.
This is the case here but we Ô¨Ånd no substantial change in behavior by using the smooth model.
This boundary was extensively used in previous problems of a superconductor with a peri- odic array of inclusions.5,6 V. CONCLUSION The vortex patterns of truly 3D mesoscopic superconduct- ors, namely, a disk and a sphere, were analyzed.
They were obtained by numerical minimization simulated annealing of a modiÔ¨Åed GL free energy that already incorporates the boundary conditions.
This procedure provides an efÔ¨Åcient way to obtain vortex patterns in mesoscopic superconductors and needs relatively few grid points.
The method is stable under changes of the grid size, and its results are comparable to those obtained by other methods.21 We Ô¨Ånd that slight changes of the boundary conditions, such as the creation of a surface layer, increases the upper critical Ô¨Åeld and allows for an increase in the number of angular momentum states.
In the case of a mesoscopic sphere, we Ô¨Ånd that the vortex lines are naturally curved due to strong surface effects, as was recently also found in a wire with a constriction.19 ACKNOWLEDGMENTS A.R. de C.R. acknowledges support from CNPq Brazil.
M.M.D. acknowledges support from CNPq Brazil, FAPERJ Brazil, the Instituto do Mil√™nio de Nanotecnologia Brazil, and BOF/UA Belgium. F.M.P. acknowledges support from the Flemish Science Foundation FWO-Vl, the Belgian Science Policy IUAP, and the ESF-AQDJJ network.
*Electronic address: mmd@if.ufrj.br; URL: http://www.if.ufrj.br/ Àúmmd ‚Ä†Electronic address: francois.peeters@ua.ac.be; URL: http:// www.cmt.ua.ac.be 1V. A. Schweigert, F. M. Peeters, and P. S. Deo, Phys. Rev. Lett.
81, 2783 1998. 2V. A. Schweigert and F. M. Peeters, Phys.
Rev. B 57, 13817 1998. 3A. K. Geim, I. V. Grigorieva, S. V. Dubonos, J. G. S. Lok, J. C. Maan, A. E. Filippov, and F. M. Peeters, Nature London 390, 259 1997. 4A. Kanda, B. J. Baelus, F. M. Peeters, K. Kadowaki, and Y. Ootuka, Phys. Rev. Lett.
93, 257002 2004. 5M. M. Doria and A. R. de C. Romaguera, Europhys. Lett.
67, 446 2004; cond-mat/0407599 to be published.
6M. M. Doria and G. F. Zebende, Phys.
Rev. B 66, 064519 2002. 7G. S. Mkrtchyan and V. V. Schmidt, Sov. Phys.
JETP 34, 195 1972. 8A. I. Buzdin, Phys.
Rev. B 47, 11416 1993. 9M. M. Doria and S. C. B. de Andrade, Phys.
Rev. B 60, 13164 1999. 10G. R. Berdiyorov, M. V. Milo≈°eviƒá, and F. M. Peeters, Phys. Rev. Lett.
96, 207001 2006. 11S. Raedts, A. V. Silhanek, M. J. Van Bael, and V. V. Moshchalkov, Phys.
Rev. B 70, 024509 2004. 12A. Bezryadin, A. Buzdin, and B. Pannetier, Phys.
Rev. B 51, 3718 1995. 13A. Bezryadin, A. Buzdin, and B. Pannetier, Phys. Lett.
A 195, 373 1994. 14V. V. Moshchalkov, M. Baert, V. V. Metlushko, E. Rosseel, M. J. Van Bael, K. Temst, R. Jonckheere, and Y. Bruynseraede, Phys. Rev. B 54, 7385 1996. 15A. V. Silhanek, S. Raedts, M. J. Van Bael, and V. V. Mosh- chalkov, Phys.
Rev. B 70, 054515 2004. 16M. Murakami, N. Sakai, T. Higuchi, and S. I. Yoo, Supercond.
Sci. Technol. 9, 1015 1996. 17Y. Shi, N. H. Babu, and D. A. Cardwell, Supercond.
Sci. Technol. 18, L13 2005. 18Q. Du, J. Math.
Phys. 46, 095109 2005. 19A. K. Elmurodov, D. Y. Vodolazov, and F. M. Peeters, Europhys. Lett.
74, 151 2006. 20G. R. Berdiyorov, M. V. Milosevic, B. J. Baelus, and F. M. Peeters, Phys.
Rev. B 70, 024508 2004. 21B. J. Baelus and F. M. Peeters, Phys.
Rev. B 65, 104515 2002. 22D. Saint-James and P. G. de Gennes, Phys. Lett.
7, 306 1963. 23M. M. Doria and A. R. de C. Romaguera, Braz.
J. Phys. 35, 157 2005; cond-mat/0411046 to be published. 24A. R. de C. Romaguera and M. M. Doria, Eur. Phys.
J. B 42, 3 2004. 25M. M. Doria, J. E. Gubernatis, and D. Rainer, Phys.
Rev. B 41, 6335 1990. 26M. M. Doria, J. E. Gubernatis, and D. Rainer, Phys.
Rev. B 39, 9573 1989. 27E. H. Brandt, J. Low Temp.
Phys. 44, 33 1981. 28O. Buisson, G. Carneiro, and M. Doria, Physica C 185, 1465 1991. EFFECT OF THE BOUNDARY CONDITION ON THE‚Ä¶ PHYSICAL REVIEW B 75, 064505 2007 064505-7